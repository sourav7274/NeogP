<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
    </style>
</head>
<body class="container mt-5">
  <h1>Travel Destinations</h1>
  <h2 class="mt-4">Get Destinations</h2>  
  <button id="getB" class="btn btn-primary my-3">Get Destinations</button>
  <div id="show"></div>
  <h1 class="mt-4">Add Destination</h1>
  <form id="addForm">
    <label class="mt-3" for="nameI">Name:</label><br>
    <input type="text" class="form-control mt-2" id="nameI"><br>
    <label class="" for="locationI">Location:</label><br>
    <input type="text" class="form-control mt-2" id="locationI"><br>
    <label class="" for="descriptionI">Description:</label><br>
    <textarea class="form-control" rows="5" id="descriptionI"></textarea><br>
    <label class="" for="ratingI">Rating:</label><br>
    <input type="number" class="form-control mt-2" id="ratingI"><br>
    <input type="submit" value="Add Destination" class="btn btn-success"></input>
  </form>
  <div id="showm" class="mt-3"></div>
  
  <script>
    const show = document.getElementById("show")
    const showm = document.getElementById("showm")
    const apiUrl = 'https://tripy-express-student-neog.replit.app/destinations'
    const getB = document.getElementById("getB")
    const addForm = document.getElementById("addForm")


    getB.addEventListener("click",function(event){
        event.preventDefault()
        fetch(apiUrl).then(function(response){
            return response.json()
        }).then(function(data){
            if(data)
            {
                show.style.display = "block"
                for(let i =0;i<data.length;i++)
                {
                    const card = document.createElement("div")
                    card.className = "card mb-3"
                    const cardb = document.createElement("div")
                    cardb.className = "card-body"
                    cardb.innerHTML = `
                    <p><b>${data[i].name}</b></p>
                    <p><b>Location: </b>${data[i].location}</p>
                    <p><b>Description: </b>${data[i].description}</p>
                    <p><b>Rating: </b>${data[i].rating}</p>                
                    `

                    card.appendChild(cardb)
                    show.appendChild(card)
                }                 
            }
        })
    })


    addForm.addEventListener("submit",function(event){
        event.preventDefault()
        const name = document.getElementById("nameI")
        const location = document.getElementById("locationI")
        const description = document.getElementById("descriptionI")
        const rating = document.getElementById("ratingI")


        const data = {
            name:name.value,
            location:location.value,
            description:description.value,
            rating:rating.value
        }
        fetch(apiUrl,{
            method:"POST",
            body:JSON.stringify(data),
            headers:{
                'Content-type':'application/json'
            }
        }).then(function(response){
            return response.json()
        }).then(function(data){
            if(data)
            {
                showm.textContent = "Destination Added Successfully"
                addForm.reset()
            }
            else
            {
                showm.textContent = "Unable to Post"
            }
        }).catch(function(error){
            showm.textContent = "Some Error Occured"
        })
    })
  </script>
</body>
</html>