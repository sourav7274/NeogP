<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
    </style>
</head>
<body class="container mt-5">
  <h1>Restaurant Data</h1>
  <h2 class="mt-4">Get Restaurants</h2>  
  <button id="getB" class="btn btn-primary my-3">Get Restaurants</button>
  <div id="show"></div>
  <h1 class="mt-4">Add Restaurant</h1>
  <form id="addForm">
    <label class="mt-3" for="nameI">Name:</label><br>
    <input type="text" class="form-control mt-2" id="nameI"><br>
    <label class="" for="cuisineI">Cuisine:</label><br>
    <input type="text" class="form-control mt-2" id="cuisineI"><br>
    <label class="" for="addressI">Address:</label><br>
    <textarea class="form-control" rows="5" id="addressI"></textarea><br>
    <label class="" for="cityI">City:</label><br>
    <textarea class="form-control" rows="5" id="cityI"></textarea><br>
    <label class="" for="ratingI">Rating:</label><br>
    <input type="number" class="form-control mt-2" id="ratingI"><br>
    <label for="fileI">Restaurant Picture: </label><br>
    <input type="url" class="form-control" name="" id="fileI"><br><br>
    <input type="submit" value="Add Destination" class="btn btn-success"></input>
  </form>
  <div id="showm" class="mt-3"></div>
  
  <script>
    const show = document.getElementById("show")
    const showm = document.getElementById("showm")
    const apiUrl = ' https://zomato-express-student-neog.replit.app/restaurants'
    const getB = document.getElementById("getB")
    const addForm = document.getElementById("addForm")


    getB.addEventListener("click",function(event){
        event.preventDefault()
        fetch(apiUrl).then(function(response){
            return response.json()
        }).then(function(data){
            if(data)
            {
                console.log(data)
                show.style.display = "block"
                for(let i =0;i<data.length;i++)
                {
                    const card = document.createElement("div")
                    card.className = "card mb-3 w-25"
                    const cardb = document.createElement("div")
                    const img = document.createElement("img")
                    img.className = "card-img-top"
                    img.src = data[i].restaurantPicture
                    img.alt = data[i].name
                    cardb.className = "card-body"
                    cardb.innerHTML = `
                    <h5 class="card-title">${data[i].name}</h5>
                    <p><b>Cuisine: </b>${data[i].cuisine}</p>
                    <p><b>Address: </b>${data[i].address}</p>
                    <p><b>Rating: </b>${data[i].rating}</p>                
                    `

                    card.appendChild(img)
                    card.appendChild(cardb)
                    show.appendChild(card)
                }                 
            }
        })
    })


    addForm.addEventListener("submit",function(event){
        event.preventDefault()
        const name = document.getElementById("nameI")
        const cuisine = document.getElementById("cuisineI")
        const address = document.getElementById("addressI")
        const city = document.getElementById("cityI")
        const rating = document.getElementById("ratingI")
        const file = document.getElementById("fileI")


        const data = {
            name:name.value,
            cuisine:cuisine.value,
            address:address.value,
            rating:rating.value,
            city:city.value,
            restaurantPicture:file.value
        }
        fetch(apiUrl,{
            method:"POST",
            body:JSON.stringify(data),
            headers:{
                'Content-type':'application/json'
            }
        }).then(function(response){
            return response.json()
        }).then(function(data){
            if(data)
            {
                
                showm.textContent = "Restaurant Added Successfully"
                addForm.reset()
            }
            else
            {
                showm.textContent = "Unable to Post"
            }
        }).catch(function(error){
            showm.textContent = "Some Error Occured"
        })
    })
  </script>
</body>
</html>