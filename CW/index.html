<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Movie Database</h1>
        <h2 class="mt-3">Get Movies</h2>
        <button id="getMB" class="btn btn-primary mt-3">Get Movies</button>
        <div class="mt-3" id="show"></div>
        <h2 class="mt-3">POST Movie</h2><br>
        <form id="details">
            <label for="titleI">Title:</label>
            <input class="form-control" type="text" id="titleI"><br>
            <label for="yearI">Release Year:</label>
            <input class="form-control" type="number" id="yearI"><br>
            <label for="">Genre:</label>
            <select class="form-select" id="genreI">
                <option value="Action">Action</option>
                <option value="Drama">Drama</option>
                <option value="Comedy">Comedy</option>
                <option value="Romance">Romance</option>
                <option value="Thriller">Thriller</option>           
                <option value="Fantasy">Fantasy</option>           
                <option value="Sci-fi">Sci-fi</option>           
                <option value="Horror">Horror</option>           
                <option value="Sports">Sports</option>           
                <option value="Musical">Musical</option>           
                <option value="Other">Other</option>        
            </select><br>
            <label for="directorI">Director:</label>
            <input class="form-control" type="text" id="directorI"><br>
            <label for="langI">Language:</label>
            <input class="form-control" type="text" id="langI"><br>
            <label for="">Country:</label>
            <select class="form-select" id="countryI">
                <option value="India">India</option>
                <option value="UK">UK</option>
                <option value="USA">USA</option>
            </select><br>
            <label for="ratingI">Rating:</label>
            <input class="form-control" type="number" id="ratingI"><br>
            <label for="plotI">Plot:</label>
            <textarea class="form-control"  id="plotI" cols="30" rows="3"></textarea><br>
            <label for="awardsI">Awards:</label>
            <input class="form-control" type="text" id="awardsI"><br>
            <label for="posteruI">Poster URL:</label>
            <input class="form-control" type="text" id="posteruI"><br>
            <label for="traileruI">Trailer URL:</label>
            <input class="form-control" type="text" id="traileruI"><br>
            <button type="submit" class="btn btn-success">Add Movie</button>
            <div class="mt-3" id="addS"></div>
        </form>
    </div>


    <script>
        const getMB = document.getElementById("getMB")
        const titleI = document.getElementById("titleI")
        const yearI = document.getElementById("yearI")
        const genreI = document.getElementById("genreI")
        const directorI = document.getElementById("directorI")
        const langI = document.getElementById("langI")
        const countryI = document.getElementById("countryI")
        const ratingI = document.getElementById("ratingI")
        const plotI = document.getElementById("plotI")
        const awardsI = document.getElementById("awardsI")
        const posteruI = document.getElementById("posteruI")
        const traileruI = document.getElementById("traileruI")
        const details = document.getElementById("details")
        const urlApi = 'https://va-5-assignment-express-student-neog.replit.app/movies'
        const addS = document.getElementById("addS")
        const show = document.getElementById("show")

        getMB.addEventListener("click",function(event){
            event.preventDefault()
            fetch(urlApi).then(function(response){
                return response.json()
            }).then(function(data){
                for(let i=0;i<data.length;i++)
                {
                    const card = document.createElement('div')
                    card.className = "card mt-3"
                    const cardBody = document.createElement('div')
                    cardBody.className = "card-body"

                    cardBody.innerHTML = `
                       <h2>Movie ID:${data[i]._id}</h2>
                       {<br>
                           &nbsp; "_id":"${data[i]._id}",<br>
                           &nbsp; "title":"${data[i].title}",<br>
                           &nbsp; "releaseYear":"${data[i].releaseYear}",<br>
                           &nbsp; "genre":"${data[i].genre}",<br>
                           &nbsp; "director":"${data[i].director}",<br>
                           &nbsp; "actor":[ ],<br>
                           &nbsp; "language":"${data[i].language}",<br>
                           &nbsp; "country":"${data[i].country}",<br>
                           &nbsp; "plot":"${data[i].plot}",<br>
                           &nbsp; "awards":"${data[i].awards}",<br>
                           &nbsp; "posterUrl":"${data[i].posterUrl}",<br>
                           &nbsp; "trailerUrl":"${data[i].trailerUrl}",<br>
                           &nbsp; "createdAt":"${data[i].createdAt}",<br>
                           &nbsp; "updatedAt":"${data[i].updatedAt}"<br>
                       }
                    `
                    card.appendChild(cardBody)
                    show.appendChild(card)
                }
            })
        })

        details.addEventListener("submit",function(event){
            event.preventDefault()
            const data = {
                title:titleI.value,
                releaseYear:yearI.value,
                rating:ratingI.value,
                awards:awardsI.value,
                director:directorI.value,
                country:countryI.value,
                genre:[genreI.value],
                plot:plotI.value,
                posterUrl:posteruI.value,
                trailerUrl:traileruI.value,
                language:langI.value
            }
            fetch(urlApi,{
                method:"POST",
                body:JSON.stringify(data),
                headers:{
                    'Content-Type':'application/json'
                }
            }).then(function(response){
                return response.json()
            }).then(function(data){
                if(data)
                {
                    addS.textContent = 'Movie Added Successfully'
                }
                else
                {
                    addS.textContent = 'Failed to Add'
                }
            }).catch(function(errro){
                addS.textContent = 'Unable to POST'
            })
        })
    </script>
</body>
</html>